<app-header></app-header>
<!-- CATEGORY SECTION -->
<div class="greeting-card-section py-5">
  <div class="container">
    <div class="row align-items-center g-5">

      <!-- CỘT TRÁI -->
      <div class="col-lg-6">
        <h2 class="display-4 fw-bold mb-4 lh-sm" style="font-family: 'Playfair Display', serif;">
          Danh mục sản phẩm nào bạn cần?<br>Đã tìm thấy rồi?
        </h2>
        <p class="lead mb-4 text-dark opacity-90">
          Không cần cuộn mãi để xem các danh mục sản phẩm. Chúng tôi đã chọn lọc
          những danh mục tinh tế và đầy cảm xúc cho mọi khoảnh khắc của cuộc sống —
          từ niềm vui, nỗi buồn đến những điều dịu dàng ở giữa.
          Tất cả được hiện thị ngay bên đây và rất vui khi nó có thể giúp ích được cho bạn.
        </p>
        <a (click)="scrollToProducts()" class="btn-cta-link fw-medium fs-5">
          Xem thêm sản phẩm
          <i class="fas fa-arrow-right ms-2"></i>
        </a>
      </div>

      <!-- CỘT PHẢI: ẢNH THIỆP -->
      <div class="col-lg-6 position-relative">
        <div class="card-image-wrapper">
          @for (occasion of occasions.slice(0,5); track occasion.id) {
          <img [src]="getOccasionThumbnailUrl(occasion.thumbnail)" alt="Small Card {{ occasion.id }}"
            class="card-small-{{ occasion.id }} shadow">
          } @empty {
          <div class="text-center py-5">
            <p class="text-muted">Không có danh mục sản phẩm nào</p>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CATEGORIES WITH PRODUCTS SECTION -->
<div id="product-section">
  @for (occasion of occasions; track occasion.id) {
  <div class="greeting-card-section-forone py-5">
    <div class="container">
      <div class="row align-items-center g-5">

        <!-- CỘT TRÁI -->
        <div class="col-lg-6">
          <h2 class="display-4 fw-bold mb-4 lh-sm" style="font-family: 'Playfair Display', serif;">
            {{ occasion.name }}
          </h2>
          <p class="lead mb-4 text-dark opacity-90">
            {{ occasion.description }}
          </p>
          <a routerLink="/occasion/{{ occasion.id }}" class="btn-cta-link fw-medium fs-5">
            Các sản phẩm liên quan
            <i class="fas fa-arrow-right ms-2"></i>
          </a>
        </div>

        <!-- CỘT PHẢI: ẢNH THIỆP -->
        <div class="col-lg-6 position-relative">
          <div class="card-image-wrapper">
            <img [src]="getOccasionThumbnailUrl(occasion.thumbnail)" alt="Small Card {{ occasion.id }}"
              class="card-main shadow">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="featured-products-section py-5 bg-white">
    <div class="container">
      <div class="occasion-block mb-5">
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 g-lg-5">
          @for (product of getProductsByOccasion(occasion.id); track product.id) {
          <div class="col">
            <div class="product-minimal" (click)="onProductClick(product.id)">

              <img [src]="product.thumbnailUrl" [alt]="product.name" class="product-img img-fluid rounded-2 mb-2">

              <h3 class="product-name fs-6 fw-medium text-dark mb-1" style="font-family: 'Playfair Display', serif;">{{
                product.name }}</h3>
              <p class="product-subtitle text-muted small mb-2" style="font-size: 12px;font-style: italic;">
                {{ product.description || 'The design darling' }}
              </p>
              <p class="product-price mb-1">{{ product.price | currency: 'VND':'symbol':'1.0-0'}}</p>
              <div class="product-actions d-flex gap-1 mt-2">
                @if(product.stockQuantity>0){
              <button class=" btn-sm btn-outline-light-product flex-fill"
                (click)="$event.stopPropagation(); addToCart($event, product.id)">
                Thêm vào giỏ
              </button>
              }@else{
              <button class="btn btn-sm btn-danger flex-fill fw-medium" disabled>
                <i class="fas fa-ban me-1"></i> Hết hàng
              </button>
              }
              </div>
            </div>
          </div>
          } @empty {
          <div class="col-12 text-center py-4 text-muted">
            <p>Chưa có sản phẩm cho danh mục này</p>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
  } @empty {
  <div class="text-center py-5">
    <p class="text-muted">Không có danh mục sản phẩm nào</p>
  </div>
  }
</div>
<app-footer></app-footer>